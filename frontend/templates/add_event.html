<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Register | Event Linker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/registration.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">
</head>

<body class="body-card-login">

    <!-- Form Container -->
    <div class="form-card">

        <div class="logo">
            <span class="logo-text">Event Linker</span>
            <small class="logo-tagline">An Integrated Event Networking Platform</small>
        </div>

        <form action="{{ url_for('organizer_bp.save_event') }}" method="POST" enctype="multipart/form-data">

            <!-- CATEGORY -->
            <div class="form-group">
                <label for="category">Category</label>
                <select id="category" name="category" required>
                    <option value="" disabled selected>Select your event category</option>
                    {% for cat in categories %}
                    <option value="{{ cat.category_id }}">{{ cat.category_name }}</option>
                    {% else %}
                    <option value="" disabled>No categories available</option>
                    {% endfor %}
                </select>
            </div>

            <!-- TITLE -->
            <div class="form-group">
                <label for="title">Event title</label>
                <input type="title" id="title" name="title" required>
            </div>

            <!-- DESCRIPTION -->
            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" rows="3" placeholder="Event description..."></textarea>
            </div>

            <!-- DATE + LIVE VALIDATION -->
            <div class="form-group">
                <label for="date">Event Date and Time</label>
                <input type="datetime-local" id="date" name="date" required>
                <small id="dateWarning" style="color:#ff8080; display:none; font-size:0.85rem;">
                    âš  Event date must be in the future.
                </small>
            </div>

            <!-- LOCATION -->
            <div class="form-group">
                <label for="location">Location</label>
                <input type="text" id="location" name="location" placeholder="location">
            </div>

            <!-- IMAGE -->
            <div class="form-group">
                <label for="image_file">Event Image</label>
                <input type="file" id="image_file" name="image_file" accept="image/png, image/jpeg, image/gif">
                <small>Max file size: 16MB. Allowed types: PNG, JPG, JPEG, GIF.</small>
            </div>

            <button type="submit" class="btn-primary form-submit-btn">Submit</button>
        </form>
    </div>

    <!-- ERROR MODAL -->
    <div id="errorModal" class="modal" style="display:none;">
        <div class="modal-content">
            <h3>Error</h3>
            <p id="modalMessage" style="margin-top: 10px;"></p>
            <button onclick="closeErrorModal()" class="btn-primary" style="margin-top: 15px;">OK</button>
        </div>
    </div>

</body>


<!-- SCRIPT SECTION -->
<script>
    // -------------------------------
    // Disable Past Dates Completely
    // -------------------------------
    const dateInput = document.getElementById("date");

    function setMinDate() {
        const now = new Date();
        now.setSeconds(0, 0);
        const iso = now.toISOString().slice(0, 16); // YYYY-MM-DDTHH:MM
        dateInput.min = iso;
    }
    setMinDate();


    // -------------------------------
    // Live Warning Text
    // -------------------------------
    const dateWarning = document.getElementById("dateWarning");

    dateInput.addEventListener("input", function () {
        const selected = new Date(this.value);
        const now = new Date();

        if (selected < now) {
            dateWarning.style.display = "block";
            this.style.border = "1px solid #ff4d4d";
        } else {
            dateWarning.style.display = "none";
            this.style.border = "1px solid rgba(255,255,255,0.15)";
        }
    });


    // -------------------------------
    // Prevent Submit if date is past
    // -------------------------------
    const eventForm = document.querySelector("form");

    eventForm.addEventListener("submit", function (e) {
        const selectedDate = new Date(dateInput.value);
        const now = new Date();

        if (selectedDate < now) {
            e.preventDefault();
            showErrorModal("Event date must be in the future!");
        }
    });


</script>


</html>